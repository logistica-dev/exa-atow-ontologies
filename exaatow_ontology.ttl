@prefix exa: <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/exaatow_ontology.ttl#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dc: <http://purl.org/dc/elements/1.1/> .

# Domain Exa-AToW ontologies
@prefix workf: <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/workflow_ontology/exaatow_workflow_ontology.ttl#> .
@prefix pie: <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/impactsHPC_ontology/PIE.ttl#> .
@prefix hpc: <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/hpc_ontology/exaatow_hpc_ontology.ttl#> .

# =========================================
# Ontology Metadata
# =========================================

<https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/exaatow_ontology.ttl>
    a owl:Ontology ;
    dc:title "Exa-AToW Integrated Ontology" ;
    dc:description "Integration ontology linking workflow, HPC infrastructure, job submission, and environmental impact assessment for HPC-based workflows and applications." ;
    dc:creator "Exa-AToW Project" ;
    dc:date "2025-12-05"^^xsd:date ;
    owl:versionInfo "1.0" ;
    
    # Import the three domain ontologies
    owl:imports <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/workflow_ontology/exaatow_workflow_ontology.ttl> ,
                <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/impactsHPC_ontology/PIE.ttl> ,
                <https://raw.githubusercontent.com/logistica-dev/exa-atow-ontologies/refs/heads/main/hpc_ontology/exaatow_hpc_ontology.ttl> .

# =========================================
# Cross-Domain Mappings: Equivalent Classes
# =========================================
# Map equivalent computational resource concepts
hpc:Processor owl:equivalentClass pie:processor .
hpc:CPU owl:equivalentClass pie:cpu .
hpc:GPU owl:equivalentClass pie:gpu .
hpc:RAM owl:equivalentClass pie:ram .
hpc:SSD owl:equivalentClass pie:ssd .
hpc:HDD owl:equivalentClass pie:hdd .
hpc:Server owl:equivalentClass pie:server .

# Map HPC infrastructure to impact assessment
hpc:Supercomputer rdfs:subClassOf pie:park .
hpc:Partition rdfs:subClassOf pie:cluster .


# =========================================
# ADD Cross-Domain Mappings: Equivalent Properties
# =========================================
# Energy and performance properties
hpc:coreCount owl:equivalentProperty pie:coresNumber .

# Temporal properties alignment
workf:duration owl:equivalentProperty pie:duration .


# =========================================
# ADD Cross-Domain Relationships
# =========================================

# ===== Workflow → HPC Infrastructure =====

# Link workflow execution environments to HPC resources
workf:HPCEnvironment rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty exa:utilizesHPCResource ;
    owl:someValuesFrom hpc:HPCResource
] .

# Computational resources used by execution environments
exa:utilizesHPCResource a owl:ObjectProperty ;
    rdfs:domain workf:ExecutionEnvironment ;
    rdfs:range hpc:HPCResource ;
    rdfs:label "utilizes HPC resource"@en ,
               "utilise ressource HPC"@fr ;
    rdfs:comment "Links a workflow execution environment to the physical or logical HPC resources it uses."@en .

# Link workflow executions to HPC partitions/clusters
exa:executedOnPartition a owl:ObjectProperty ;
    rdfs:domain workf:Execution ;
    rdfs:range hpc:Partition ;
    rdfs:label "executed on partition"@en ,
               "exécuté sur partition"@fr ;
    rdfs:comment "Specifies which HPC partition was used for workflow execution."@en .

# Link workflow steps to compute nodes
exa:usesComputeNode a owl:ObjectProperty ;
    rdfs:domain workf:WorkflowStep ;
    rdfs:range hpc:ComputeNode ;
    rdfs:label "uses compute node"@en ,
               "utilise nœud de calcul"@fr ;
    rdfs:comment "Indicates which compute nodes execute a specific workflow step."@en .

# ===== Workflow → Environmental Impact =====

# Workflow executions have environmental impacts
# not sure, to be discussed.
workf:Execution rdfs:subClassOf pie:job .

# Link workflow to impact assessment
exa:hasEnvironmentalImpact a owl:ObjectProperty ;
    rdfs:domain [ owl:unionOf ( workf:Workflow workf:Execution workf:WorkflowStep ) ] ;
    rdfs:range pie:impactEstimation ;
    rdfs:label "has environmental impact"@en ,
               "a impact environnemental"@fr ;
    rdfs:comment "Associates a workflow entity with its estimated environmental impact."@en .

# Add that workflow metadata includes environmental assessment (not mandatory?)
#workf:WorkflowMetadata rdfs:subClassOf [
#    a owl:Restriction ;
#    owl:onProperty exa:includesImpactAssessment ;
#    owl:someValuesFrom pie:impactEstimation
#] .

exa:includesImpactAssessment a owl:ObjectProperty ;
    rdfs:domain workf:WorkflowMetadata ;
    rdfs:range pie:impactEstimation ;
    rdfs:label "includes impact assessment"@en ,
               "inclut évaluation d'impact"@fr .

# ===== HPC Infrastructure → Environmental Impact =====

# HPC resources are impact-assessed objects
hpc:HPCResource rdfs:subClassOf pie:impactAssessedObject .

# ===== Three-way Integration: Workflow Execution Context =====

# A complete workflow execution context
exa:WorkflowExecutionContext a owl:Class ;
    rdfs:label "Workflow Execution Context"@en ,
               "Contexte d'exécution de workflow"@fr ;
    rdfs:comment "Integrates workflow execution with HPC infrastructure usage and environmental impact assessment."@en ;
    rdfs:subClassOf [
        a owl:Restriction ;
        owl:onProperty exa:hasWorkflowExecution ;
        owl:someValuesFrom workf:Execution
    ] ,
    [
        a owl:Restriction ;
        owl:onProperty exa:onHPCInfrastructure ;
        owl:someValuesFrom hpc:HPCResource
    ] ,
    [
        a owl:Restriction ;
        owl:onProperty exa:withEnvironmentalImpact ;
        owl:someValuesFrom pie:impactEstimation
    ] .

exa:hasWorkflowExecution a owl:ObjectProperty ;
    rdfs:domain exa:WorkflowExecutionContext ;
    rdfs:range workf:Execution ;
    rdfs:label "has workflow execution"@en .

exa:onHPCInfrastructure a owl:ObjectProperty ;
    rdfs:domain exa:WorkflowExecutionContext ;
    rdfs:range hpc:HPCResource ;
    rdfs:label "on HPC infrastructure"@en .

exa:withEnvironmentalImpact a owl:ObjectProperty ;
    rdfs:domain exa:WorkflowExecutionContext ;
    rdfs:range pie:impactEstimation ;
    rdfs:label "with environmental impact"@en .

